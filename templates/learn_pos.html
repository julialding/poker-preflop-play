{% extends "layout.html" %}
{% block content %}
<div class="container mt-5">
    <div class="learn-container">
        <h1 class="text-center mb-4">Learn Poker Pre-Flop Betting</h1>
        
        <div class="card shadow-sm p-4">
            <h2 class="card-title">Lesson 1: Table Positions</h2>
            
        <div class="lesson-content">
                <h3 class="mb-3">Position Overview</h3>
                <p>Pre-flop decisions are heavily influenced by your position at the table. Understanding position is crucial for successful poker play.</p>
                <p class="text-muted mt-3"><i>Hover over different positions on the table image below to learn more about each position.</i></p>
        </div>
            <!-- Position Image with Interactive Areas -->
<div class="text-center my-4">
    <div class="poker-table-container">
        <img src="static/images/poker_pos.png" 
             alt="Poker Table Positions" 
             class="img-fluid rounded poker-table-img" 
             style="max-width: 600px;">
        
        <!-- Clickable/Hoverable Areas -->
        <div class="position-area early-position" data-position="early">
            <!-- UTG Area -->
        </div>
        <div class="position-area middle-position" data-position="middle">
            <!-- MP/HJ Area -->
        </div>
        <div class="position-area late-position" data-position="late">
            <!-- CO/BTN Area -->
        </div>
        <div class="position-area deal-position" data-position="deal">
            <!-- CO/BTN Area -->
        </div>
        <div class="position-area sb-position" data-position="sb">
            <!-- SB Area -->
        </div>
        <div class="position-area bb-position" data-position="bb">
            <!-- BB Area -->
        </div>
        
        <!-- Description Cards -->
        <div class="position-description-card" id="early-position-card">
            <div class="card-pointer left-pointer"></div>
            <h4 class="text-primary">Early Position (EP)</h4>
            <ul>
                <li>First positions to act after the blinds</li>
                <li>Play tight range â€“ premium hands only</li>
                <li>Recommended hands: AA, KK, QQ, AKs</li>
                <li>Most difficult position to play from</li>
            </ul>
        </div>

        <div class="position-description-card" id="middle-position-card">
            <div class="card-pointer left-pointer"></div>
            <h4 class="text-success">Middle Position (MP)</h4>
            <ul>
                <li>More flexibility than Early Position</li>
                <li>Can play moderate range</li>
                <li>Include premium hands and strong suited connectors</li>
                <li>Consider players still to act</li>
            </ul>
        </div>

        <div class="position-description-card" id="late-position-card">
            <div class="card-pointer right-pointer"></div>
            <h4 class="text-info">Late Position (LP)</h4>
            <ul>
                <li>Best position to play from</li>
                <li>Can play wider range of hands</li>
                <li>Opportunity to steal blinds</li>
                <li>More information about opponents' actions</li>
            </ul>
        </div>

        <div class="position-description-card" id="deal-position-card">
            <div class="card-pointer right-pointer"></div>
            <h4 class="text-info">Late Position (LP)</h4>
            <ul>
                <li>Best position to play from</li>
                <li>Can play wider range of hands</li>
                <li>Opportunity to steal blinds</li>
                <li>More information about opponents' actions</li>
            </ul>
        </div>

        <div class="position-description-card" id="sb-position-card">
            <div class="card-pointer right-pointer"></div>
            <h4 class="text-warning">Small Blind (SB)</h4>
            <ul>
                <li>Worst position post-flop</li>
                <li>Already invested half a big blind</li>
                <li>Play very selectively</li>
                <li>Often caught out of position post-flop</li>
            </ul>
        </div>

        <div class="position-description-card" id="bb-position-card">
            <div class="card-pointer left-pointer"></div>
            <h4 class="text-warning">Big Blind (BB)</h4>
            <ul>
                <li>Can defend more widely</li>
                <li>Already invested a full big blind</li>
                <li>Last to act pre-flop</li>
                <li>Need to be selective with defense ranges</li>
            </ul>
        </div>
    </div>
</div>

        <!-- Navigation Buttons -->
        <div class="d-flex justify-content-between mt-4">
            <a href="/learn" class="btn btn-secondary">Back</a>
            <a href="/learn/2" class="btn btn-primary">Next Lesson</a>
        </div>
    </div>
</div>

<style>
.position-explanations .card {
    transition: transform 0.2s;
}

.position-explanations .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.lesson-content ul {
    list-style-type: none;
    padding-left: 0;
}

.lesson-content ul li {
    padding: 8px 0;
    border-bottom: 1px solid #eee;
}

.lesson-content ul li:last-child {
    border-bottom: none;
}

/* Poker Table Interactive Styles */
.poker-table-container {
    position: relative;
    display: inline-block;
    margin: 0 auto;
    max-width: 600px;
}

/* Add styles for the pointer/arrow connecting cards to positions */
.card-pointer {
    position: absolute;
    width: 15px;
    height: 15px;
    background-color: white;
    transform: rotate(45deg);
    border: 1px solid #ddd;
    z-index: 1;
}

.left-pointer {
    right: -7px;
    top: 20px;
    border-left: none;
    border-bottom: none;
}

.right-pointer {
    left: -7px;
    top: 20px;
    border-right: none;
    border-top: none;
}

.position-area {
    position: absolute;
    width: 120px;
    height: 120px;
    border-radius: 50%;
    cursor: pointer;
    z-index: 10;
    transition: background-color 0.2s;
}

.position-area:hover {
    /* Extremely subtle hover effect */
    background-color: rgba(0, 123, 255, 0.05);
}

/* Position areas on the table */
.early-position {
    top: 20%;
    left: 5%;
}

.middle-position {
    top: 5%;
    left: 40%;
}

.late-position {
    top: 14%;
    right: 6%;
}

.deal-position {
    bottom: 15%;
    right: 2%;
}

.sb-position {
    bottom: 1%;
    left: 47%;
}

.bb-position {
    bottom: 4%;
    left: 13%;
}

/* Description Cards */
.position-description-card {
    display: none;
    position: absolute;
    background-color: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    z-index: 20;
    width: 280px;
    text-align: left;
    transition: opacity 0.3s ease;
    pointer-events: none; /* This prevents the card from capturing mouse events */
    opacity: 0;
}

/* We'll position these in JavaScript dynamically */
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Get all position areas
    const positionAreas = document.querySelectorAll('.position-area');
    const tableContainer = document.querySelector('.poker-table-container');
    const tableImg = document.querySelector('.poker-table-img');
    
    // Add mouse events to each area
    positionAreas.forEach(area => {
        const position = area.getAttribute('data-position');
        const card = document.getElementById(`${position}-position-card`);
        
        // Show card on hover with smooth transition
        area.addEventListener('mouseenter', function(e) {
            // Position the card based on the area's position relative to the table
            positionCard(position, card, this, tableImg);
            
            // Show the card with fade-in effect
            card.style.display = 'block';
            setTimeout(() => {
                card.style.opacity = '1';
            }, 10);
        });
        
        area.addEventListener('mouseleave', function() {
            // Fade out effect
            card.style.opacity = '0';
            setTimeout(() => {
                card.style.display = 'none';
            }, 300); // Match transition duration
        });
    });
    
    // Function to dynamically position cards directly next to the table
    function positionCard(position, card, area, tableImg) {
        const areaRect = area.getBoundingClientRect();
        const tableRect = tableImg.getBoundingClientRect();
        const cardWidth = 280; // Width from CSS
        
        // Reset card positioning
        card.style.top = 'auto';
        card.style.bottom = 'auto';
        card.style.left = 'auto';
        card.style.right = 'auto';
        
        // Center the card vertically with the hovered area
        const cardTop = areaRect.top - tableRect.top + (areaRect.height / 2) - 75; // Approximate center
        card.style.top = cardTop + 'px';
        
        // Position cards directly beside the table image
        if (position === 'early' || position === 'middle' || position === 'bb') {
            // Position to the left of the table
            card.style.right = '100%';
            card.style.marginRight = '15px';
            
            // Adjust pointer position
            const pointerElement = card.querySelector('.card-pointer');
            pointerElement.className = 'card-pointer right-pointer';
            pointerElement.style.left = 'auto';
            pointerElement.style.right = '-7px';
        } else {
            // Position to the right of the table
            card.style.left = '100%';
            card.style.marginLeft = '15px';
            
            // Adjust pointer position
            const pointerElement = card.querySelector('.card-pointer');
            pointerElement.className = 'card-pointer left-pointer';
            pointerElement.style.right = 'auto';
            pointerElement.style.left = '-7px';
        }
    }
});
</script>
{% endblock %}